{"ast":null,"code":"import { FormBuilder } from \"@angular/forms\";\nimport { Store } from \"@ngrx/store\";\nimport * as fromReducer from \"../../store/orders/orders.reducer\";\nimport * as fromActions from \"../../store/orders/orders.actions\";\nimport { OrderObject } from \"../../store/modal/order.modal\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@ngrx/store\";\nexport let OrderOrdersComponent = /*#__PURE__*/(() => {\n  class OrderOrdersComponent {\n    constructor(formBuilder, store) {\n      this.formBuilder = formBuilder;\n      this.store = store;\n      this.task = \"\";\n      this.orForm = {};\n      this.allOrders$ = store.select(fromReducer.selectAllOrders);\n      //this.allOrders$.subscribe((res) => console.log(res));\n      this.count$ = store.select(fromReducer.OrdersCount);\n      this.orIds$ = store.select(fromReducer.selectOrderIds);\n      this.orById$ = store.select(fromReducer.selectCurrentOrder);\n      this.orId = 0;\n    }\n    ngOnInit() {\n      this.store.dispatch(fromActions.LoadOrders());\n    }\n    createBlankOrderForm() {\n      this.orForm = this.formBuilder.group({\n        orsArray: this.formBuilder.array([])\n      });\n    }\n    createOrderFormForAdd() {\n      this.createBlankOrderForm();\n      this.addMoreControlForAdd();\n    }\n    get orsFormArray() {\n      console.log(\"@hereee\");\n      return this.orForm?.get(\"orsArray\");\n    }\n    addMoreControlForAdd() {\n      let ag = this.formBuilder.group(new OrderObject());\n      this.orsFormArray.push(ag);\n    }\n    updateOrderForm() {\n      this.createBlankOrderForm();\n      this.allOrders$.subscribe(ors => {\n        console.log(\"updateOrderForm\" + ors);\n        if (ors && ors.length > 0) {\n          let or = ors[0];\n          console.log(\"updateOrderForm\" + or);\n          let ag = this.formBuilder.group(or);\n          this.orsFormArray.push(ag);\n        }\n      });\n    }\n    addMoreControlForUpdate() {\n      this.allOrders$.subscribe(ors => {\n        if (ors && ors.length > 0 && this.orsFormArray?.length < ors.length) {\n          let len = this.orsFormArray.length;\n          let Order = ors[len];\n          let ag = this.formBuilder.group(Order);\n          this.orsFormArray.push(ag);\n        }\n      });\n    }\n    deleteFormArrayControl(idx) {\n      this.orsFormArray.removeAt(idx);\n    }\n    addOrderView() {\n      this.task = \"add\";\n      this.createOrderFormForAdd();\n    }\n    updateOrderView() {\n      this.task = \"update\";\n      this.updateOrderForm();\n    }\n    removeOrderView() {\n      this.task = \"remove\";\n      this.createBlankOrderForm();\n      this.allOrders$.subscribe(ors => {\n        this.createBlankOrderForm();\n        ors.forEach(Order => {\n          let ag = this.formBuilder.group({\n            OrderData: Order,\n            chk: false\n          });\n          this.orsFormArray.push(ag);\n        });\n      });\n    }\n    orByIdView() {\n      this.task = \"select\";\n    }\n    onFormSubmitForAdd() {\n      if (this.orsFormArray.length === 1) {\n        this.addOrder(this.orsFormArray.at(0).value);\n      } else if (this.orsFormArray.length > 1) {\n        this.addOrders(this.orsFormArray.value);\n      }\n      this.createBlankOrderForm();\n      this.loadAllOrders();\n    }\n    onFormSubmitForUpdate() {\n      if (this.orsFormArray.length === 1) {\n        this.updateOrder(this.orsFormArray.at(0).value);\n      } else if (this.orsFormArray.length > 1) {\n        this.updateOrders(this.orsFormArray.value);\n      }\n      this.createBlankOrderForm();\n      this.loadAllOrders();\n    }\n    onFormSubmitForRemove() {\n      let OrderIdsToDelete = [];\n      this.orsFormArray.controls.forEach(result => {\n        if (result.get(\"chk\")?.value) {\n          OrderIdsToDelete.push(result.get(\"OrderData\")?.value.id);\n        }\n      });\n      if (OrderIdsToDelete.length == 1) {\n        this.removeOrder(OrderIdsToDelete[0]);\n      } else if (OrderIdsToDelete.length > 1) {\n        this.removeOrders(OrderIdsToDelete);\n      }\n    }\n    addOrder(data) {\n      if (data == null) return;\n      this.store.dispatch(fromActions.AddOrder({\n        payload: {\n          or: data\n        }\n      }));\n    }\n    addOrders(data) {\n      if (data == null) return;\n      this.store.dispatch(fromActions.AddOrders({\n        payload: {\n          ors: data\n        }\n      }));\n    }\n    updateOrder(data) {\n      if (data == null) return;\n      this.store.dispatch(fromActions.UpdateOrder({\n        payload: {\n          or: {\n            id: data.id,\n            changes: data\n          }\n        }\n      }));\n    }\n    updateOrders(data) {\n      if (data == null) return;\n      let allUpdates = data.map(Order => Object.assign({}, {\n        id: Order.id,\n        changes: Order\n      }));\n      this.store.dispatch(fromActions.UpdateOrders({\n        payload: {\n          ors: allUpdates\n        }\n      }));\n    }\n    removeOrder(orId) {\n      if (orId == null) return;\n      this.store.dispatch(fromActions.RemoveOrder({\n        payload: {\n          id: orId\n        }\n      }));\n    }\n    removeOrders(orIds) {\n      if (orIds == null) return;\n      this.store.dispatch(fromActions.RemoveOrders({\n        payload: {\n          ids: orIds\n        }\n      }));\n    }\n    clearAllOrders() {\n      this.store.dispatch(fromActions.ClearOrders());\n    }\n    loadAllOrders() {\n      this.task = \"all\";\n    }\n    selectOrderById() {\n      this.store.dispatch(fromActions.SelectOrder({\n        payload: {\n          orId: this.orId\n        }\n      }));\n    }\n    static {\n      this.ɵfac = function OrderOrdersComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || OrderOrdersComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Store));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: OrderOrdersComponent,\n        selectors: [[\"user-orders\"]],\n        standalone: false,\n        decls: 2,\n        vars: 0,\n        template: function OrderOrdersComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"h1\");\n            i0.ɵɵtext(1, \"Orders\");\n            i0.ɵɵelementEnd();\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return OrderOrdersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}